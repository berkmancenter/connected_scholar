<p>
  <b>Title:</b>
  <%= resource.title %>
</p>

<p>
  <b>Creators:</b>
<ul>
  <% for c in resource.creators %>
      <li><%= c %></li>
  <% end %>
</ul>
</p>

<p>
  <b>Publication date:</b>
  <%= resource.publication_date %>
</p>

<p>
  <b>Publisher:</b>
  <%= resource.publisher %>
</p>

<p>
  <b>ISBN:</b>
<ul>
  <% for c in resource.id_isbn %>
      <li><%= c %></li>
  <% end %>
</ul>
</p>
<hr style="margin: 5px 0 5px 0"/>
<p>
  <b>Links:</b>
<ul>
  <% if resource.id_hollis %>
      <li><%= link_to "Hollis", item_link(resource.id_hollis), :target => "_blank" %></li>
  <% end %>
</ul>
</p>

<hr style="margin: 5px 0 5px 0"/>

<p>
  <b>Recognized Citations:</b>
<%= form_for([resource.document, resource, resource.citations.build]) do |f| %>
    <table style="width:100%">
      <% for c in resource.citations %>
          <% if c.id %> <!-- The call to .build created a bogus one -->
              <tr>
                <td><%= c.citation_text %></td>
                <td style="width:auto">
                  <% if c.default %>
                    default
                  <% else %>
                    <% link_to "make default",  %>
                  <% end %>
                </td>
                <td style="width:auto">
                  <%= link_to "delete", [resource.document, resource, c],
                              :confirm => <<TXT, :method => :delete
The following citation will no longer be recognized:

   #{c.citation_text}

Are you sure?
TXT
                  %>
                </td>
              </tr>
          <% end %>
      <% end %>
      <tr>
        <td colspan="2"><%= f.text_field :citation_text, :size => 30, :placeholder => "Add Recognized Citation" %></td>
        <td style="width:auto"><%= f.submit "add" %></td>
      </tr>
    </table>
<% end %>
</p>

<hr style="margin: 5px 0 5px 0"/>

<p>
  <%= link_to 'Delete this Resource', [resource.document, resource],
              :confirm => 'Are you sure?',
              :method => :delete %>
</p>

<script type="text/javascript">
    jQuery(document).ready(function() {
//        $("#add-recognized-citation-link").click(function() {
//            $("#add-recognized-citation-dialog").dialog("open");
//            return false;
//        });

        $("#add-recognized-citation-dialog").dialog({
            title: "Add Citation",
            autoOpen: false,
            height: 200,
            width: 330,
            modal: true,
            buttons: {
                "Add Citation": function() {
                    $(":button:contains('Add Citation')").attr("disabled", "disabled").addClass('ui-state-disabled');
                    $("#new_citation").submit();
                },
                "Cancel": function() {
                    $(this).dialog("close");
                }
            }
        });
    });
</script>